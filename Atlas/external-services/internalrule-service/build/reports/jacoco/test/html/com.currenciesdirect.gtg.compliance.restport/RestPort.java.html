<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RestPort.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">internalrule-service</a> &gt; <a href="index.source.html" class="el_package">com.currenciesdirect.gtg.compliance.restport</a> &gt; <span class="el_source">RestPort.java</span></div><h1>RestPort.java</h1><pre class="source lang-java linenums">/**
 * 
 */
package com.currenciesdirect.gtg.compliance.restport;

import java.util.ArrayList;
import java.util.List;

import javax.ws.rs.Consumes;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

import com.currenciesdirect.gtg.compliance.core.InternalService;
import com.currenciesdirect.gtg.compliance.core.InternalServicesFacade;
import com.currenciesdirect.gtg.compliance.core.whitelistbeneficiary.IWhitelistBeneficiaryModifier;
import com.currenciesdirect.gtg.compliance.core.whitelistbeneficiary.WhitelistBeneficiaryModifierImpl;
import com.currenciesdirect.gtg.compliance.commons.domain.internalruleservice.ContactResponse;
import com.currenciesdirect.gtg.compliance.commons.domain.internalruleservice.InternalServiceRequest;
import com.currenciesdirect.gtg.compliance.commons.domain.internalruleservice.InternalServiceRequestData;
import com.currenciesdirect.gtg.compliance.commons.domain.internalruleservice.InternalServiceResponse;
import com.currenciesdirect.gtg.compliance.commons.domain.internalruleservice.WhitelistBeneficiaryRequest;
import com.currenciesdirect.gtg.compliance.commons.domain.internalruleservice.WhitelistBeneficiaryResponse;
import com.currenciesdirect.gtg.compliance.exception.Errors;
import com.currenciesdirect.gtg.compliance.exception.InternalRuleErrors;
import com.currenciesdirect.gtg.compliance.exception.InternalRuleException;
import com.currenciesdirect.gtg.compliance.util.Constants;
import com.currenciesdirect.gtg.compliance.util.RequestTypes;

/**
 * @author manish
 *
 */
@Path(&quot;/&quot;)
<span class="nc" id="L37">public class RestPort {</span>

<span class="nc" id="L39">	private InternalService internalService = InternalServicesFacade.getInstance();</span>

<span class="nc" id="L41">	private IWhitelistBeneficiaryModifier whitelistBeneficiaryModifier = WhitelistBeneficiaryModifierImpl.getInstance();</span>
	
<span class="nc" id="L43">	private static final org.slf4j.Logger LOG = org.slf4j.LoggerFactory.getLogger(RestPort.class);</span>

	/**
	 * 
	 * @param headers
	 * @param request
	 * @return
	 */
	@POST
	@Path(&quot;/checkRegistration&quot;)
	@Consumes(MediaType.APPLICATION_JSON)
	@Produces(MediaType.APPLICATION_JSON)
	public Response checkRegistration(InternalServiceRequest request) {
<span class="nc" id="L56">		LOG.debug(&quot;RestPort : checkRegistration method Start&quot;);</span>
<span class="nc" id="L57">		InternalServiceResponse response = new InternalServiceResponse();</span>
		try {
<span class="nc" id="L59">			response = internalService.performCheck(request);</span>
<span class="nc" id="L60">		} catch (InternalRuleException exception) {</span>
<span class="nc" id="L61">			LOG.error(Constants.ERROR_IN_RESTPORT_MESSAGE, exception);</span>
<span class="nc" id="L62">			response = createServiceFailureResponse(request, exception.getErrors());</span>
<span class="nc" id="L63">		} catch (Exception e) {</span>
<span class="nc" id="L64">			LOG.error(&quot;Error in RestPort : checkRegistration method&quot;, e);</span>
<span class="nc" id="L65">			response = createServiceFailureResponse(request, InternalRuleErrors.FAILED);</span>
<span class="nc" id="L66">		}</span>
<span class="nc" id="L67">		LOG.debug(&quot;RestPort: checkRegistration END&quot;);</span>
<span class="nc" id="L68">		return Response.status(200).entity(response).build();</span>

	}

	/**
	 * Show blacklist data.
	 *
	 * @param request
	 *            the request
	 * @return the response
	 */
	@POST
	@Path(&quot;/showBlacklistData&quot;)
	@Consumes(MediaType.APPLICATION_JSON)
	@Produces(MediaType.APPLICATION_JSON)
	public Response showBlacklistData(InternalServiceRequest request) {
<span class="nc" id="L84">		LOG.debug(&quot;RestPort : showBlacklistData method Start&quot;);</span>
<span class="nc" id="L85">		InternalServiceResponse response = new InternalServiceResponse();</span>
		try {
<span class="nc" id="L87">			request.setRequestType(RequestTypes.SHOW_BLACKLIST_DATA + &quot;&quot;);</span>
<span class="nc" id="L88">			response = internalService.performCheck(request);</span>
<span class="nc" id="L89">		} catch (InternalRuleException exception) {</span>
<span class="nc" id="L90">			LOG.error(Constants.ERROR_IN_RESTPORT_MESSAGE, exception);</span>
<span class="nc" id="L91">			response = createServiceFailureResponse(request, exception.getErrors());</span>
<span class="nc" id="L92">		} catch (Exception e) {</span>
<span class="nc" id="L93">			LOG.error(&quot;Error in RestPort : showBlacklistData method&quot;, e);</span>
<span class="nc" id="L94">			response = createServiceFailureResponse(request, InternalRuleErrors.FAILED);</span>
<span class="nc" id="L95">		}</span>
<span class="nc" id="L96">		LOG.debug(&quot;RestPort : showBlacklistData method End&quot;);</span>
<span class="nc" id="L97">		return Response.status(200).entity(response).build();</span>
	}

	/**
	 * Save into blacklist data.
	 *
	 * @param request
	 *            the request
	 * @return the response
	 */
	@POST
	@Path(&quot;/saveIntoBlacklistData&quot;)
	@Consumes(MediaType.APPLICATION_JSON)
	@Produces(MediaType.APPLICATION_JSON)
	public Response saveIntoBlacklistData(InternalServiceRequest request) {
<span class="nc" id="L112">		LOG.debug(&quot;RestPort : saveIntoBlacklistData method Start&quot;);</span>
<span class="nc" id="L113">		InternalServiceResponse response = new InternalServiceResponse();</span>
		try {
<span class="nc" id="L115">			request.setRequestType(RequestTypes.ADD_BLACKLIST_DATA + &quot;&quot;);</span>
<span class="nc" id="L116">			response = internalService.performCheck(request);</span>
<span class="nc" id="L117">		} catch (InternalRuleException exception) {</span>
<span class="nc" id="L118">			LOG.error(Constants.ERROR_IN_RESTPORT_MESSAGE, exception);</span>
<span class="nc" id="L119">			response = createServiceFailureResponse(request, exception.getErrors());</span>
<span class="nc" id="L120">		} catch (Exception e) {</span>
<span class="nc" id="L121">			LOG.error(&quot;Error in RestPort : saveIntoBlacklistData method&quot;, e);</span>
<span class="nc" id="L122">			response = createServiceFailureResponse(request, InternalRuleErrors.FAILED);</span>

<span class="nc" id="L124">		}</span>
<span class="nc" id="L125">		LOG.debug(&quot;RestPort : saveIntoBlacklistData method End&quot;);</span>
<span class="nc" id="L126">		return Response.status(200).entity(response).build();</span>
	}

	/**
	 * Delete from blacklist data.
	 *
	 * @param request
	 *            the request
	 * @return the response
	 */
	@POST
	@Path(&quot;/deleteFromBlacklist&quot;)
	@Consumes(MediaType.APPLICATION_JSON)
	@Produces(MediaType.APPLICATION_JSON)
	public Response deleteFromBlacklist(InternalServiceRequest request) {
<span class="nc" id="L141">		LOG.debug(&quot;RestPort : deleteFromBlacklist method Start&quot;);</span>
<span class="nc" id="L142">		InternalServiceResponse response = new InternalServiceResponse();</span>
		try {
<span class="nc" id="L144">			request.setRequestType(RequestTypes.DELETE_BLACKLIST_DATA + &quot;&quot;);</span>
<span class="nc" id="L145">			response = internalService.performCheck(request);</span>
<span class="nc" id="L146">		} catch (InternalRuleException exception) {</span>
<span class="nc" id="L147">			LOG.error(Constants.ERROR_IN_RESTPORT_MESSAGE, exception);</span>
<span class="nc" id="L148">			response = createServiceFailureResponse(request, exception.getErrors());</span>
<span class="nc" id="L149">		} catch (Exception e) {</span>
<span class="nc" id="L150">			LOG.error(&quot;Error in RestPort : deleteFromBlacklist method&quot;, e);</span>
<span class="nc" id="L151">			response = createServiceFailureResponse(request, InternalRuleErrors.FAILED);</span>

<span class="nc" id="L153">		}</span>
<span class="nc" id="L154">		LOG.debug(&quot;RestPort : deleteFromBlacklist method End&quot;);</span>
<span class="nc" id="L155">		return Response.status(200).entity(response).build();</span>
	}

	/**
	 * Search into blacklist data.
	 *
	 * @param request
	 *            the request
	 * @return the response
	 */
	@POST
	@Path(&quot;/searchBlacklistData&quot;)
	@Consumes(MediaType.APPLICATION_JSON)
	@Produces(MediaType.APPLICATION_JSON)
	public Response searchBlacklistData(InternalServiceRequest request) {
<span class="nc" id="L170">		LOG.debug(&quot;RestPort : searchBlacklistData method Start&quot;);</span>
<span class="nc" id="L171">		InternalServiceResponse response = new InternalServiceResponse();</span>
		try {
<span class="nc" id="L173">			request.setRequestType(RequestTypes.SEARCH_BLACKLIST_DATA + &quot;&quot;);</span>
<span class="nc" id="L174">			response = internalService.performCheck(request);</span>
<span class="nc" id="L175">		} catch (InternalRuleException exception) {</span>
<span class="nc" id="L176">			LOG.error(Constants.ERROR_IN_RESTPORT_MESSAGE, exception);</span>
<span class="nc" id="L177">			response = createServiceFailureResponse(request, exception.getErrors());</span>
<span class="nc" id="L178">		} catch (Exception e) {</span>
<span class="nc" id="L179">			LOG.error(&quot;Error in RestPort : searchBlacklistData method&quot;, e);</span>
<span class="nc" id="L180">			response = createServiceFailureResponse(request, InternalRuleErrors.FAILED);</span>

<span class="nc" id="L182">		}</span>
<span class="nc" id="L183">		LOG.debug(&quot;RestPort : searchBlacklistData method End&quot;);</span>
<span class="nc" id="L184">		return Response.status(200).entity(response).build();</span>
	}

	/**
	 * Creates the service failure response.
	 *
	 * @param request
	 *            the request
	 * @return the internal service response
	 */
	private InternalServiceResponse createServiceFailureResponse(InternalServiceRequest request, Errors ex) {
<span class="nc" id="L195">		InternalServiceResponse response = new InternalServiceResponse();</span>
<span class="nc" id="L196">		List&lt;ContactResponse&gt; contactResponseList = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L197" title="All 2 branches missed.">		for (InternalServiceRequestData contactRequest : request.getSearchdata()) {</span>
<span class="nc" id="L198">			ContactResponse contactResponse = new ContactResponse();</span>
<span class="nc" id="L199">			contactResponse.setId(contactRequest.getId());</span>
<span class="nc" id="L200">			contactResponse.setEntityType(contactRequest.getEntityType());</span>
<span class="nc" id="L201">			contactResponseList.add(contactResponse);</span>
<span class="nc" id="L202">		}</span>
<span class="nc" id="L203">		response.setStatus(Constants.SERVICE_FAILURE);</span>
<span class="nc" id="L204">		response.setContacts(contactResponseList);</span>
<span class="nc" id="L205">		response.setErrorCode(ex.getErrorCode());</span>
<span class="nc" id="L206">		response.setErrorDescription(ex.getErrorDescription());</span>
<span class="nc" id="L207">		return response;</span>
	}
	
	
	/**
	 * Show WhitelistBeneficiary data.
	 *
	 * @param request
	 *            the request
	 * @return the response
	 */
	@POST
	@Path(&quot;/showWhiteListBeneficiaryData&quot;)
	@Consumes(MediaType.APPLICATION_JSON)
	@Produces(MediaType.APPLICATION_JSON)
	public Response showWhitelistBeneficiaryData(WhitelistBeneficiaryRequest request) {
<span class="nc" id="L223">		LOG.debug(&quot;RestPort : showWhitelistBeneficiaryData method Start&quot;);</span>
<span class="nc" id="L224">		List&lt;WhitelistBeneficiaryResponse&gt; response = null;</span>
		try {
<span class="nc" id="L226">			response = whitelistBeneficiaryModifier.getWhitelistBeneficiaryData(request);</span>
<span class="nc" id="L227">		} catch (Exception e) {</span>
<span class="nc" id="L228">			LOG.error(&quot;Error in RestPort : showWhitelistBeneficiaryData method&quot;, e);</span>
<span class="nc" id="L229">		}</span>
<span class="nc" id="L230">		LOG.debug(&quot;RestPort : showWhitelistBeneficiaryData method End&quot;);</span>
<span class="nc" id="L231">		return Response.status(200).entity(response).build();</span>
	}
	
	
	/**
	 * Save into WhitelistBeneficiary data.
	 *
	 * @param request
	 *            the request
	 * @return the response
	 */
	@POST
	@Path(&quot;/saveIntoWhitelistBeneficiaryData&quot;)
	@Consumes(MediaType.APPLICATION_JSON)
	@Produces(MediaType.APPLICATION_JSON)
	public Response saveIntoWhitelistBeneficiaryData(WhitelistBeneficiaryRequest request) {
<span class="nc" id="L247">		LOG.debug(&quot;RestPort : saveIntoWhiteBeneficiarylistData method Start&quot;);</span>
<span class="nc" id="L248">		WhitelistBeneficiaryResponse response = new WhitelistBeneficiaryResponse();</span>
		try {
<span class="nc" id="L250">			response = whitelistBeneficiaryModifier.saveIntoWhitelistBeneficiaryData(request);</span>
<span class="nc" id="L251">		} catch (InternalRuleException exception) {</span>
<span class="nc" id="L252">			LOG.error(Constants.ERROR_IN_RESTPORT_MESSAGE, exception);</span>
<span class="nc" id="L253">			Errors ex = exception.getErrors();</span>
<span class="nc" id="L254">			response.setStatus(Constants.SERVICE_FAILURE);</span>
<span class="nc" id="L255">			response.setErrorCode(ex.getErrorCode());</span>
<span class="nc" id="L256">			response.setErrorDescription(ex.getErrorDescription());</span>
<span class="nc" id="L257">		} catch (Exception e) {</span>
<span class="nc" id="L258">			LOG.error(&quot;Error in RestPort : saveIntoWhiteBeneficiarylistData method&quot;, e);</span>
<span class="nc" id="L259">			response.setStatus(Constants.SERVICE_FAILURE);</span>
<span class="nc" id="L260">		}</span>
<span class="nc" id="L261">		LOG.debug(&quot;RestPort : saveIntoWhiteBeneficiarylistData method End&quot;);</span>
<span class="nc" id="L262">		return Response.status(200).entity(response).build();</span>
	}
	
	/**
	 * Delete from WhiteListBeneficiary data.
	 *
	 * @param request
	 *            the request
	 * @return the response
	 */
	@POST
	@Path(&quot;/deleteFromWhiteListBeneficiary&quot;)
	@Consumes(MediaType.APPLICATION_JSON)
	@Produces(MediaType.APPLICATION_JSON)
	public Response deleteFromWhiteListBeneficiary(WhitelistBeneficiaryRequest request) {
<span class="nc" id="L277">		LOG.debug(&quot;RestPort : deleteFromWhiteListBeneficiary method Start&quot;);</span>
<span class="nc" id="L278">		WhitelistBeneficiaryResponse response = new WhitelistBeneficiaryResponse();</span>
		try {
<span class="nc" id="L280">			response = whitelistBeneficiaryModifier.deleteFromWhiteListBeneficiaryData(request);</span>
<span class="nc" id="L281">		} catch (Exception e) {</span>
<span class="nc" id="L282">			LOG.error(&quot;Error in RestPort : deleteFromWhiteListBeneficiary method&quot;, e);</span>
<span class="nc" id="L283">			response.setStatus(Constants.SERVICE_FAILURE);</span>
<span class="nc" id="L284">		}</span>
<span class="nc" id="L285">		LOG.debug(&quot;RestPort : deleteFromWhiteListBeneficiary method End&quot;);</span>
<span class="nc" id="L286">		return Response.status(200).entity(response).build();</span>
	}
	
	/**
	 * Search into blacklist data.
	 *
	 * @param request
	 *            the request
	 * @return the response
	 */
	@POST
	@Path(&quot;/searchWhiteListBeneficiaryData&quot;)
	@Consumes(MediaType.APPLICATION_JSON)
	@Produces(MediaType.APPLICATION_JSON)
	public Response searchWhiteListBeneficiaryData(WhitelistBeneficiaryRequest request) {
<span class="nc" id="L301">		LOG.debug(&quot;RestPort : searchBlacklistData method Start&quot;);</span>
<span class="nc" id="L302">		List&lt;WhitelistBeneficiaryResponse&gt; response = null;</span>
		try {
<span class="nc" id="L304">			response = whitelistBeneficiaryModifier.searchWhiteListBeneficiaryData(request);</span>
<span class="nc" id="L305">		} catch (Exception e) {</span>
<span class="nc" id="L306">			LOG.error(&quot;Error in RestPort : searchBlacklistData method&quot;, e);</span>
<span class="nc" id="L307">		}</span>
<span class="nc" id="L308">		LOG.debug(&quot;RestPort : searchBlacklistData method End&quot;);</span>
<span class="nc" id="L309">		return Response.status(200).entity(response).build();</span>
	}


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>