<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UserPermissionBuilder.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">compliance-portal</a> &gt; <a href="index.source.html" class="el_package">com.currenciesdirect.gtg.compliance.iam.core</a> &gt; <span class="el_source">UserPermissionBuilder.java</span></div><h1>UserPermissionBuilder.java</h1><pre class="source lang-java linenums">package com.currenciesdirect.gtg.compliance.iam.core;

import com.currenciesdirect.gtg.compliance.httpport.ViewControllerConstant;
import com.currenciesdirect.gtg.compliance.iam.core.domain.Role;
import com.currenciesdirect.gtg.compliance.iam.core.domain.UserPermission;

/**
 * The Class RegistationDetailsPermissionBuilder.
 */
public class UserPermissionBuilder {

	private UserPermission permission;

	private Role role;

	/**
	 * Instantiates a new registation details permission builder.
	 *
	 * @param role
	 *            the role
	 */
<span class="fc" id="L22">	public UserPermissionBuilder(Role role) {</span>
<span class="fc" id="L23">		this.role = role;</span>
<span class="fc" id="L24">		permission = new UserPermission();</span>
<span class="fc" id="L25">	}</span>

	/**
	 * Builds the.
	 *
	 * @return the reg details user permission
	 */
	public UserPermission build() {
<span class="nc" id="L33">		return permission;</span>
	}

	/**
	 * Builds the service permissions.
	 *
	 * @return the user permission builder
	 */
	public UserPermissionBuilder buildServicePermissions() {
<span class="fc" id="L42">		permission.setCanManageSanction(isFunctionAllowed(ViewControllerConstant.CAN_MANAGE_SANCTION));</span>
<span class="fc" id="L43">		permission.setCanManageEID(isFunctionAllowed(ViewControllerConstant.CAN_MANAGE_EID));</span>
<span class="fc" id="L44">		permission.setCanManageCustom(isFunctionAllowed(ViewControllerConstant.CAN_MANAGE_CUSTOM));</span>
<span class="fc" id="L45">		permission.setCanManageBlackList(isFunctionAllowed(ViewControllerConstant.CAN_MANAGE_BLACKLIST));</span>
<span class="fc" id="L46">		permission.setCanManageFraud(isFunctionAllowed(ViewControllerConstant.CAN_MANAGE_FRAUD));</span>
<span class="fc" id="L47">		permission.setCanManageWatchListCategory1(isFunctionAllowed(ViewControllerConstant.CAN_MANAGE_WATCHLIST_CATEGORY_1));</span>
<span class="fc" id="L48">		permission.setCanManageWatchListCategory2(isFunctionAllowed(ViewControllerConstant.CAN_MANAGE_WATCHLIST_CATEGORY_2));</span>
<span class="fc" id="L49">		return this;</span>
	}

	/**
	 * Builds the status update permissions.
	 *
	 * @return the user permission builder
	 */
	public UserPermissionBuilder buildStatusUpdatePermissions() {
<span class="fc" id="L58">		return this;</span>
	}

	/**
	 * Builds the status reason permissions.
	 *
	 * @return the user permission builder
	 */
	public UserPermissionBuilder buildStatusReasonPermissions() {
<span class="fc" id="L67">		return this;</span>
	}

	/**
	 * Builds the locking permissions.
	 *
	 * @return the user permission builder
	 */
	public UserPermissionBuilder buildLockingPermissions() {
<span class="fc" id="L76">		permission.setCanUnlockRecords(isFunctionAllowed(ViewControllerConstant.CAN_UNLOCK));</span>
<span class="fc" id="L77">		return this;</span>
	}

	/**
	 * Builds the cust type permissions.
	 *
	 * @return the user permission builder
	 */
	public UserPermissionBuilder buildCustTypePermissions() {
<span class="fc" id="L86">		permission.setCanWorkOnCFX(isFunctionAllowed(ViewControllerConstant.CAN_WORK_ON_CFX));</span>
<span class="fc" id="L87">		permission.setCanWorkOnPFX(isFunctionAllowed(ViewControllerConstant.CAN_WORK_ON_PFX));</span>
<span class="fc" id="L88">		return this;</span>
	}

	/**
	 * Builds the page permissions.
	 *
	 * @return the user permission builder
	 */
	public UserPermissionBuilder buildPagePermissions() {
		
<span class="fc" id="L98">		permission.setCanViewPaymentInQueue(isFunctionAllowed(ViewControllerConstant.CAN_VIEW_PAYMENTIN_QUQUE));</span>
<span class="fc" id="L99">		permission.setCanViewPaymentOutQueue(isFunctionAllowed(ViewControllerConstant.CAN_VIEW_PAYMENTOUT_QUQUE));</span>
<span class="fc" id="L100">		permission.setCanViewRegistrationQueue(isFunctionAllowed(ViewControllerConstant.CAN_VIEW_REGISTRTION_QUQUE));</span>
<span class="fc" id="L101">		permission.setCanViewRegistrationReport(isFunctionAllowed(ViewControllerConstant.CAN_VIEW_REGISTRTION_REPORT));</span>
<span class="fc" id="L102">		permission.setCanViewPaymentOutReport(isFunctionAllowed(ViewControllerConstant.CAN_VIEW_PAYMENTOUT_REPORT));</span>
<span class="fc" id="L103">		permission.setCanViewPaymentInReport(isFunctionAllowed(ViewControllerConstant.CAN_VIEW_PAYMENTIN_REPORT));</span>
<span class="fc" id="L104">		permission.setCanViewDashboard(isFunctionAllowed(ViewControllerConstant.CAN_VIEW_DASHBOARD));</span>
<span class="fc" id="L105">		permission.setCanViewWorkEfficiacyReport(isFunctionAllowed(ViewControllerConstant.CAN_VIEW_WORK_EFFICIANCY_REPORT));</span>
<span class="fc" id="L106">		permission.setCanInitiateDataAnon(isFunctionAllowed(ViewControllerConstant.CAN_INITIATE_DATA_ANON));</span>
<span class="fc" id="L107">		permission.setCanApproveDataAnon(isFunctionAllowed(ViewControllerConstant.CAN_APPROVE_DATA_ANON));</span>
<span class="fc" id="L108">		permission.setIsReadOnlyUser(isFunctionAllowed(ViewControllerConstant.IS_READ_ONLY_USER));</span>
<span class="fc" id="L109">		permission.setCanViewRegistrationDetails(canViewRegistrationDetailsPage());</span>
<span class="fc" id="L110">		permission.setCanViewPaymentInDetails(canViewPaymentInDetailsPage());</span>
<span class="fc" id="L111">		permission.setCanViewPaymentOutDetails(canViewPaymentOutDetailsPage());</span>
<span class="fc" id="L112">		permission.setCanManageBeneficiary(isFunctionAllowed(ViewControllerConstant.CAN_MANAGE_BENEFICIARY));</span>
<span class="fc" id="L113">		permission.setCanNotLockAccount(isFunctionAllowed(ViewControllerConstant.CAN_NOT_LOCK_ACCOUNT));</span>
<span class="fc" id="L114">		return this;</span>
	}

	/**
	 * Builds the administration permissions.
	 *
	 * @return the user permission builder
	 */
	public UserPermissionBuilder buildAdministrationPermissions() {
<span class="fc" id="L123">		permission.setCanDoAdministration(isFunctionAllowed(ViewControllerConstant.CAN_DO_ADMINISTRATION));</span>
<span class="fc" id="L124">		return this;</span>
	}

	public UserPermission getUserPermissions() {
<span class="fc" id="L128">		return this.permission;</span>
	}

	private Boolean isFunctionAllowed(String funcationName) {
<span class="fc" id="L132">		return role.getFunctionByName(funcationName).getHasAccess();</span>
	}

	private boolean canViewRegistrationDetailsPage() {
<span class="pc bpc" id="L136" title="1 of 2 branches missed.">		if (!permission.getCanViewRegistrationQueue()) {</span>
<span class="fc" id="L137">			return false;</span>
		}
<span class="nc bnc" id="L139" title="All 6 branches missed.">		return permission.getCanManageEID() || permission.getCanManageFraud() || permission.getCanManageBlackList()</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">				|| permission.getCanManageSanction();</span>

	}
	
	private boolean canViewPaymentInDetailsPage() {
<span class="pc bpc" id="L145" title="1 of 2 branches missed.">		if (!permission.getCanViewPaymentInQueue()) {</span>
<span class="fc" id="L146">			return false;</span>
		}
<span class="nc bnc" id="L148" title="All 4 branches missed.">		boolean permissionofManageFraudBlacklist=permission.getCanManageFraud() || permission.getCanManageBlackList();</span>
<span class="nc bnc" id="L149" title="All 6 branches missed.">		boolean permissionofManageSanctionCustomWatchlist= permission.getCanManageSanction() || permission.getCanManageCustom() || permission.getCanManageWatchListCategory1();</span>
        
<span class="nc bnc" id="L151" title="All 4 branches missed.">		return permissionofManageFraudBlacklist||permissionofManageSanctionCustomWatchlist;</span>
	}
	
	private boolean canViewPaymentOutDetailsPage() {
<span class="pc bpc" id="L155" title="1 of 2 branches missed.">		if (!permission.getCanViewPaymentOutQueue()) {</span>
<span class="fc" id="L156">			return false;</span>
		}
<span class="nc bnc" id="L158" title="All 4 branches missed.">		boolean permissionOfManageFraudBlacklist=permission.getCanManageFraud() || permission.getCanManageBlackList();</span>
<span class="nc bnc" id="L159" title="All 6 branches missed.">		boolean permissionOfManageSanctionCustomWatchlist= permission.getCanManageSanction() || permission.getCanManageCustom() || permission.getCanManageWatchListCategory1();</span>
        
<span class="nc bnc" id="L161" title="All 4 branches missed.">		return permissionOfManageFraudBlacklist||permissionOfManageSanctionCustomWatchlist;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>