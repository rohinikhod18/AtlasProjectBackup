<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DataAnonymisationDetailsTransformer.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">compliance-portal</a> &gt; <a href="index.source.html" class="el_package">com.currenciesdirect.gtg.compliance.transformer</a> &gt; <span class="el_source">DataAnonymisationDetailsTransformer.java</span></div><h1>DataAnonymisationDetailsTransformer.java</h1><pre class="source lang-java linenums">package com.currenciesdirect.gtg.compliance.transformer;

import java.util.List;

import org.springframework.stereotype.Component;

import com.currenciesdirect.gtg.compliance.commons.domain.fraugster.FraugsterSummary;
import com.currenciesdirect.gtg.compliance.commons.domain.profile.onfido.OnfidoSummary;
import com.currenciesdirect.gtg.compliance.core.ITransform;
import com.currenciesdirect.gtg.compliance.core.domain.AccountWrapper;
import com.currenciesdirect.gtg.compliance.core.domain.Blacklist;
import com.currenciesdirect.gtg.compliance.core.domain.Constants;
import com.currenciesdirect.gtg.compliance.core.domain.ContactWrapper;
import com.currenciesdirect.gtg.compliance.core.domain.CountryCheck;
import com.currenciesdirect.gtg.compliance.core.domain.CustomCheck;
import com.currenciesdirect.gtg.compliance.core.domain.EventDBDto;
import com.currenciesdirect.gtg.compliance.core.domain.Fraugster;
import com.currenciesdirect.gtg.compliance.core.domain.GlobalCheck;
import com.currenciesdirect.gtg.compliance.core.domain.InternalRule;
import com.currenciesdirect.gtg.compliance.core.domain.IpCheck;
import com.currenciesdirect.gtg.compliance.core.domain.Kyc;
import com.currenciesdirect.gtg.compliance.core.domain.Onfido;
import com.currenciesdirect.gtg.compliance.core.domain.RegistrationAccount;
import com.currenciesdirect.gtg.compliance.core.domain.RegistrationContact;
import com.currenciesdirect.gtg.compliance.core.domain.Sanction;
import com.currenciesdirect.gtg.compliance.core.domain.Watchlist;
import com.currenciesdirect.gtg.compliance.core.domain.dataanonymisation.DataAnonymisationDetailsDBDto;
import com.currenciesdirect.gtg.compliance.core.domain.dataanonymisation.DataAnonymisationDetailsDto;
import com.currenciesdirect.gtg.compliance.core.domain.internalrule.BlacklistSummary;
import com.currenciesdirect.gtg.compliance.core.domain.internalrule.IpSummary;
import com.currenciesdirect.gtg.compliance.core.domain.kyc.KYCSummary;
import com.currenciesdirect.gtg.compliance.core.domain.sanction.SanctionSummary;
import com.currenciesdirect.gtg.compliance.util.DateTimeFormatter;
import com.currenciesdirect.gtg.compliance.util.DecimalFormatter;
import com.currenciesdirect.gtg.compliance.util.JsonConverterUtil;
import com.currenciesdirect.gtg.compliance.util.StringUtils;

@Component(&quot;dataAnonymisationDetailsTransformer&quot;)
<span class="fc" id="L39">public class DataAnonymisationDetailsTransformer extends AbstractRegistrationTransformer implements ITransform&lt;DataAnonymisationDetailsDto, DataAnonymisationDetailsDBDto&gt;{</span>

	//@Override
	public DataAnonymisationDetailsDto transform(DataAnonymisationDetailsDBDto detailsDBDto) {    
<span class="fc" id="L43">		DataAnonymisationDetailsDto regDetailsDto = new DataAnonymisationDetailsDto();</span>
<span class="fc" id="L44">		regDetailsDto.setAccount(getAccount(detailsDBDto));</span>
<span class="fc" id="L45">		regDetailsDto.setCurrentContact(getContact(detailsDBDto));</span>
<span class="fc" id="L46">		regDetailsDto.setInternalRule(getInternalRule(detailsDBDto));</span>
<span class="fc" id="L47">		regDetailsDto.setKyc(getKyc(detailsDBDto));</span>
<span class="fc" id="L48">		regDetailsDto.setSanction(getSanction(detailsDBDto));</span>
<span class="fc" id="L49">		regDetailsDto.setFraugster(getFraugster(detailsDBDto));</span>
<span class="fc" id="L50">		regDetailsDto.setOnfido(getOnfido(detailsDBDto));</span>
<span class="fc" id="L51">		regDetailsDto.setOtherContacts(detailsDBDto.getOtherContacts());</span>
<span class="fc" id="L52">		regDetailsDto.setPaginationDetails(detailsDBDto.getPaginationDetails());</span>
<span class="fc" id="L53">		detailsDBDto.getActivityLogs().setTotalRecords(detailsDBDto.getActivityLogs().getActivityLogData().size());</span>
<span class="pc bpc" id="L54" title="1 of 2 branches missed.">		if(detailsDBDto.getActivityLogs().getActivityLogData().size() &lt;= 10){</span>
<span class="fc" id="L55">			regDetailsDto.setActivityLogs(detailsDBDto.getActivityLogs());</span>
		} else {
<span class="nc" id="L57">			detailsDBDto.getActivityLogs().setActivityLogData(detailsDBDto.getActivityLogs().getActivityLogData().subList(0, 10));</span>
<span class="nc" id="L58">			regDetailsDto.setActivityLogs(detailsDBDto.getActivityLogs());</span>
		}
<span class="fc" id="L60">		Watchlist watchlist = deleteDuplicateWatclist(detailsDBDto.getWatachList());</span>
<span class="fc" id="L61">		regDetailsDto.setWatchlist(watchlist);</span>
<span class="fc" id="L62">		regDetailsDto.setStatusReason(detailsDBDto.getContactStatusReason());</span>
<span class="pc bpc" id="L63" title="2 of 4 branches missed.">		if(detailsDBDto.getLockedBy() != null &amp;&amp; !detailsDBDto.getLockedBy().isEmpty()){</span>
<span class="fc" id="L64">			regDetailsDto.setLocked(Boolean.TRUE);</span>
<span class="fc" id="L65">			regDetailsDto.setLockedBy(detailsDBDto.getLockedBy());</span>
<span class="fc" id="L66">			regDetailsDto.setUserResourceId(detailsDBDto.getUserResourceId());</span>
		}
<span class="fc" id="L68">		regDetailsDto.setDocumentList(detailsDBDto.getDocumentList());</span>
<span class="fc" id="L69">		regDetailsDto.setAlertComplianceLog(detailsDBDto.getAlertComplianceLog());</span>
<span class="fc" id="L70">		regDetailsDto.setIsOnQueue(detailsDBDto.getIsOnQueue());</span>
<span class="fc" id="L71">		return regDetailsDto;</span>
	}
	
	/**
	 * Gets the account.
	 *
	 * @param detailsDBDto
	 *            the details DB dto
	 * @return the account
	 */
	private AccountWrapper getAccount(DataAnonymisationDetailsDBDto detailsDBDto) {
<span class="fc" id="L82">		AccountWrapper account = new AccountWrapper();</span>
<span class="fc" id="L83">		RegistrationAccount regAccount = JsonConverterUtil.convertToObject(RegistrationAccount.class,</span>
<span class="fc" id="L84">				detailsDBDto.getAccountAttrib());</span>
<span class="pc bpc" id="L85" title="1 of 2 branches missed.">		if (regAccount != null) {</span>
<span class="fc" id="L86">			account.setClientType(regAccount.getCustType());</span>
<span class="fc" id="L87">			account.setCurrencyPair(regAccount.getSellingCurrency() + &quot;  -  &quot; + regAccount.getBuyingCurrency());</span>
<span class="fc" id="L88">			account.setEstimTransValue(regAccount.getValueOfTransaction());</span>
<span class="fc" id="L89">			account.setPurposeOfTran(regAccount.getPurposeOfTran());</span>
<span class="fc" id="L90">			account.setServiceRequired(regAccount.getServiceRequired());</span>
<span class="fc" id="L91">			account.setSource(regAccount.getSource());</span>
<span class="fc" id="L92">			account.setSourceOfFund(regAccount.getSourceOfFund());</span>
<span class="fc" id="L93">			account.setRefferalText(regAccount.getReferralText());</span>
<span class="fc" id="L94">			account.setAffiliateName(regAccount.getAffiliateName());</span>
<span class="fc" id="L95">			account.setRegMode(regAccount.getRegistrationMode());</span>
<span class="fc" id="L96">			account.setConversionPrediction(regAccount.getConversionPrediction());</span>
		}
<span class="fc" id="L98">		account.setComplianceStatus(detailsDBDto.getAccComplianceStatus());</span>
<span class="fc" id="L99">		account.setId(detailsDBDto.getAccountId());</span>
<span class="fc" id="L100">		account.setOrgCode(detailsDBDto.getOrgnization());</span>
<span class="fc" id="L101">		account.setTradeAccountNumber(detailsDBDto.getTradeAccountNum());</span>
<span class="pc bpc" id="L102" title="1 of 2 branches missed.">		if(null != detailsDBDto.getRegCompAccount()){</span>
<span class="nc" id="L103">			account.setRegCompleteAccount(detailsDBDto.getRegCompAccount().toString());</span>
		}else {
<span class="fc" id="L105">			account.setRegCompleteAccount(Constants.DASH_UI);</span>
		}
<span class="pc bpc" id="L107" title="1 of 2 branches missed.">		if(null != detailsDBDto.getRegistrationInDate()){</span>
<span class="fc" id="L108">			account.setRegistrationInDate(detailsDBDto.getRegistrationInDate().toString());</span>
		}
<span class="pc bpc" id="L110" title="1 of 2 branches missed.">		if(null != detailsDBDto.getComplianceExpiry()){</span>
<span class="fc" id="L111">			account.setComplianceExpiry(detailsDBDto.getComplianceExpiry().toString());</span>
		}else {
<span class="nc" id="L113">			account.setComplianceExpiry(null);</span>
		}
<span class="pc bpc" id="L115" title="3 of 4 branches missed.">		if(null != detailsDBDto.getLegalEntity() &amp;&amp; !detailsDBDto.getLegalEntity().isEmpty())</span>
<span class="nc" id="L116">			account.setLegalEntity(detailsDBDto.getLegalEntity());</span>
<span class="fc" id="L117">		else account.setLegalEntity(Constants.DASH_UI);</span>
		
<span class="fc" id="L119">		return account;</span>

	}

	/**
	 * Gets the contact.
	 *
	 * @param detailsDBDto
	 *            the details DB dto
	 * @return the contact
	 */
	private ContactWrapper getContact(DataAnonymisationDetailsDBDto detailsDBDto) {
<span class="fc" id="L131">		RegistrationContact regContact = JsonConverterUtil.convertToObject(RegistrationContact.class,</span>
<span class="fc" id="L132">				detailsDBDto.getContactAttrib());</span>
<span class="fc" id="L133">		ContactWrapper contact = new ContactWrapper();</span>
<span class="pc bpc" id="L134" title="1 of 2 branches missed.">		if (regContact != null) {</span>
<span class="fc" id="L135">			contact.setAddress(getCompleteAddress(regContact));</span>
<span class="fc" id="L136">			contact.setCountryOfResidence(detailsDBDto.getCountryOfResidenceFullName()+&quot; (&quot;+regContact.getCountry()+&quot;)&quot;);</span>
<span class="fc" id="L137">			contact.setEmail(regContact.getEmail());</span>
<span class="fc" id="L138">			contact.setMobile(regContact.getPhoneMobile());</span>
<span class="fc" id="L139">			contact.setNationality(regContact.getNationality());</span>
<span class="fc" id="L140">			contact.setOccupation(regContact.getOccupation());</span>
<span class="fc" id="L141">			contact.setPhone(regContact.getPhoneHome());</span>
<span class="pc bpc" id="L142" title="2 of 4 branches missed.">			contact.setIsUsClient(regContact.getCountry() != null &amp;&amp; Constants.USA.equals(regContact.getCountry()));</span>
<span class="fc" id="L143">			contact.setIpAddress(regContact.getIpAddress());</span>
<span class="fc" id="L144">			contact.setIsCountrySupported(checkIsKycSupportedCountry(regContact.getCountry(),detailsDBDto.getKycSupportedCountryList(),</span>
<span class="fc" id="L145">					detailsDBDto.getOrgnization(),detailsDBDto.getLegalEntity()));</span>
<span class="fc" id="L146">			contact.setPrimaryContact(regContact.getPrimaryContact());</span>
			//added By Neelesh Pant
<span class="fc" id="L148">			contact.setDob(DateTimeFormatter.getDateInRFC3339(regContact.getDob()));</span>
<span class="fc" id="L149">			updateWorkPhone(regContact, contact);</span>
	
			//changes done to show full name on UI
<span class="pc bpc" id="L152" title="2 of 4 branches missed.">			if(regContact.getMiddleName() != null &amp;&amp; !regContact.getMiddleName().trim().isEmpty()){</span>
<span class="nc" id="L153">				String fullName = new StringBuilder().append(regContact.getFirstName()).append(&quot; &quot;).append(regContact.getMiddleName()).append(&quot; &quot;).append(regContact.getLastName()).toString();</span>
<span class="nc" id="L154">				contact.setName(fullName);</span>
<span class="nc" id="L155">			} else {</span>
<span class="fc" id="L156">				contact.setName(detailsDBDto.getContactName());</span>
			}
				
			
		}
<span class="pc bpc" id="L161" title="1 of 2 branches missed.">		if (detailsDBDto.getRegIn() != null) {</span>
<span class="nc" id="L162">			contact.setRegIn(DateTimeFormatter.dateTimeFormatter(detailsDBDto.getRegIn()));</span>
		}
<span class="pc bpc" id="L164" title="1 of 2 branches missed.">		if (detailsDBDto.getRegComp() != null) {</span>
<span class="nc" id="L165">			contact.setRegComplete(DateTimeFormatter.dateTimeFormatter(detailsDBDto.getRegComp()));</span>
		}
<span class="fc" id="L167">		contact.setAccountId(detailsDBDto.getAccountId());</span>
<span class="fc" id="L168">		contact.setId(detailsDBDto.getContactId());</span>
<span class="fc" id="L169">		contact.setTradeContactID(Integer.valueOf(detailsDBDto.getTradeContactId()));</span>
<span class="fc" id="L170">		contact.setCrmAccountId(detailsDBDto.getCrmAccountId());</span>
<span class="fc" id="L171">		contact.setCrmContactId(detailsDBDto.getCrmContactId());</span>
<span class="fc" id="L172">		contact.setComplianceStatus(detailsDBDto.getConComplianceStatus());</span>
<span class="fc" id="L173">		return contact;</span>

	}

  private void updateWorkPhone(RegistrationContact regContact, ContactWrapper contact) {
<span class="pc bpc" id="L178" title="3 of 4 branches missed.">	 if((!StringUtils.isNullOrEmpty(regContact.getPhoneWorkExtn())) &amp;&amp; (!StringUtils.isNullOrEmpty(regContact.getPhoneWork()))) {</span>
<span class="nc" id="L179">	    	contact.setPhoneWork(regContact.getPhoneWork()+&quot;;&quot;+regContact.getPhoneWorkExtn());</span>
	 }
    	
<span class="pc bpc" id="L182" title="3 of 4 branches missed.">     if((!StringUtils.isNullOrEmpty(regContact.getPhoneWorkExtn())) &amp;&amp; (StringUtils.isNullOrEmpty(regContact.getPhoneWork()))) {</span>
<span class="nc" id="L183">    	contact.setPhoneWork(regContact.getPhoneWorkExtn());</span>
     }
    
<span class="pc bpc" id="L186" title="2 of 4 branches missed.">     if((StringUtils.isNullOrEmpty(regContact.getPhoneWorkExtn()))&amp;&amp; (!StringUtils.isNullOrEmpty(regContact.getPhoneWork()))) {</span>
<span class="fc" id="L187">    	contact.setPhoneWork(regContact.getPhoneWork());</span>
     }
<span class="fc" id="L189">  }</span>

	/**
	 * Gets the internal rule.
	 *
	 * @param detailsDBDto
	 *            the details DB dto
	 * @return the internal rule
	 */
	private InternalRule getInternalRule(DataAnonymisationDetailsDBDto detailsDBDto) {
<span class="fc" id="L199">		InternalRule internalRule = new InternalRule();</span>
<span class="fc" id="L200">		internalRule.setCustomCheck(getCustomCheck(detailsDBDto));</span>
<span class="fc" id="L201">		internalRule.setBlacklist(getBlacklist(detailsDBDto));</span>
<span class="fc" id="L202">		return internalRule;</span>

	}
	
	private CustomCheck getCustomCheck(DataAnonymisationDetailsDBDto detailsDBDto){
<span class="fc" id="L207">		CustomCheck customCheck = new CustomCheck();</span>
<span class="fc" id="L208">		customCheck.setIpCheck(getIp(detailsDBDto));</span>
<span class="fc" id="L209">		customCheck.setGlobalCheck(getGlobalCheck(detailsDBDto));</span>
<span class="fc" id="L210">		customCheck.setCountryCheck(getCountryCheck(detailsDBDto));</span>
		
<span class="fc" id="L212">		customCheck.setCustomCheckTotalRecords(1);</span>
		
<span class="pc bpc" id="L214" title="3 of 4 branches missed.">		if((null != detailsDBDto.getCustomCheckStatus() || !detailsDBDto.getCustomCheckStatus().isEmpty() )</span>
<span class="pc bpc" id="L215" title="1 of 2 branches missed.">				&amp;&amp; (detailsDBDto.getCustomCheckStatus().equalsIgnoreCase(Constants.PASS) || </span>
<span class="pc bpc" id="L216" title="1 of 2 branches missed.">				detailsDBDto.getCustomCheckStatus().equalsIgnoreCase(Constants.NOT_REQUIRED_UI))){</span>
<span class="nc" id="L217">			customCheck.setPassCount(customCheck.getCustomCheckTotalRecords());	</span>
		}
		else
<span class="fc" id="L220">			customCheck.setFailCount(customCheck.getCustomCheckTotalRecords());</span>
<span class="fc" id="L221">		return customCheck;</span>
	}


	/**
	 * Gets the kyc.
	 *
	 * @param detailsDBDto
	 *            the details DB dto
	 * @return the kyc
	 */
	private Kyc getKyc(DataAnonymisationDetailsDBDto detailsDBDto) {
<span class="fc" id="L233">		List&lt;EventDBDto&gt; kycEventDBDtos = detailsDBDto.getEventDBDto().get(Constants.KYC);</span>
<span class="fc" id="L234">		Integer passCount = 0;</span>
<span class="fc" id="L235">		Integer failCount = 0;</span>
<span class="fc" id="L236">		Kyc kyc = new Kyc();</span>
<span class="pc bpc" id="L237" title="2 of 4 branches missed.">		if (kycEventDBDtos == null || kycEventDBDtos.isEmpty()) {</span>
<span class="nc" id="L238">			kyc.setKycTotalRecords(0);</span>
<span class="nc" id="L239">			return kyc;</span>
		}
<span class="fc" id="L241">		EventDBDto kycEventDBDto = kycEventDBDtos.get(0);</span>
<span class="fc" id="L242">		KYCSummary kycSummary = JsonConverterUtil.convertToObject(KYCSummary.class, kycEventDBDto.getSummary());</span>
<span class="pc bpc" id="L243" title="1 of 2 branches missed.">		if (kycSummary == null) {</span>
<span class="nc" id="L244">			kyc.setFailCount(kycEventDBDtos.size());</span>
<span class="nc" id="L245">			return kyc;</span>
		}
		
		//condition added by Vishal J to check whether we should do KYC check for pfx contact
		/*
		 * 1) We are checking status of response from KYC service if it is 'NOT_REQUIRED' 
		 *    then we are showing that on UI with other important fields also.
		 */
<span class="pc bpc" id="L253" title="1 of 2 branches missed.">		if(!Constants.NOT_REQUIRED.equalsIgnoreCase(kycSummary.getStatus()))</span>
		{
<span class="fc" id="L255">			boolean status = Constants.PASS.equals(kycSummary.getStatus());</span>
<span class="fc" id="L256">			kyc.setStatus(status);</span>
<span class="fc" id="L257">			kyc.setEidCheck(kycSummary.getEidCheck());			</span>
<span class="fc" id="L258">			kyc.setIsRequired(Boolean.TRUE);</span>
			/**if (null != kycSummary.getEidCheck()  &amp;&amp; kycSummary.getEidCheck()) {
				passCount++;
			} else {
				failCount++;
			}*/
<span class="pc bpc" id="L264" title="1 of 2 branches missed.">			if (status) {</span>
<span class="fc" id="L265">				passCount= kycEventDBDtos.size();</span>
			} else {
<span class="nc" id="L267">				failCount = kycEventDBDtos.size();</span>
			}
<span class="fc" id="L269">			kyc.setPassCount(passCount);</span>
<span class="fc" id="L270">			kyc.setFailCount(failCount);</span>
<span class="fc" id="L271">			kyc.setKycTotalRecords(kycEventDBDtos.size());</span>
<span class="fc" id="L272">		}</span>
		else
		{
			//sending status value to UI
<span class="nc" id="L276">			kyc.setIsRequired(Boolean.FALSE);</span>
<span class="nc" id="L277">			kyc.setStatusValue(Constants.NOT_REQUIRED_UI);	</span>
<span class="nc" id="L278">			kyc.setKycTotalRecords(kycEventDBDtos.size());</span>
		}
		
		//method is extracted for code re-usability
<span class="fc" id="L282">		setKycResponse(kyc, kycEventDBDto, kycSummary);		</span>
<span class="fc" id="L283">		return kyc;</span>

	}

	//this method is created for code re-usability from getKyc()
	private void setKycResponse(Kyc kyc, EventDBDto kycEventDBDto, KYCSummary kycSummary) {
<span class="fc" id="L289">		kyc.setCheckedOn(DateTimeFormatter.dateTimeFormatter(kycSummary.getCheckedOn()));</span>
<span class="fc" id="L290">		kyc.setDob(kycSummary.getDob());</span>
<span class="fc" id="L291">		kyc.setId(kycEventDBDto.getId());</span>
<span class="fc" id="L292">		kyc.setReferenceId(kycSummary.getReferenceId());</span>
<span class="fc" id="L293">		kyc.setVerifiactionResult(kycSummary.getVerifiactionResult());</span>
<span class="fc" id="L294">	}</span>

	/**
	 * Gets the sanction.
	 *
	 * @param detailsDBDto
	 *            the details DB dto
	 * @return the sanction
	 */
	private Sanction getSanction(DataAnonymisationDetailsDBDto detailsDBDto) {
<span class="fc" id="L304">		Sanction sanction = new Sanction();</span>
<span class="fc" id="L305">		Integer passCount = 0;</span>
<span class="fc" id="L306">		Integer failCount = 0;</span>
<span class="fc" id="L307">		List&lt;EventDBDto&gt; eventDBDtos = detailsDBDto.getEventDBDto().get(Constants.SANCTION);</span>
<span class="pc bpc" id="L308" title="2 of 4 branches missed.">		if (eventDBDtos == null || eventDBDtos.isEmpty()) {</span>
<span class="nc" id="L309">			sanction.setSanctionTotalRecords(0);</span>
<span class="nc" id="L310">			return sanction;</span>
		}

<span class="fc" id="L313">		EventDBDto eventDBDto = eventDBDtos.get(0);</span>
<span class="fc" id="L314">		SanctionSummary summary = JsonConverterUtil.convertToObject(SanctionSummary.class, eventDBDto.getSummary());</span>
<span class="fc" id="L315">		sanction.setEventServiceLogId(eventDBDto.getId());</span>
		
		//condition added by Vishal J to check whether we should do sanction check for pfx contact
		/*
		 * 1) We are checking status of response from sanction service if it is 'NOT_REQUIRED' 
		 *    then we are showing that on UI with other important fields also.
		 */
<span class="pc bpc" id="L322" title="2 of 4 branches missed.">		if (summary != null &amp;&amp; !Constants.NOT_REQUIRED.equalsIgnoreCase(summary.getStatus())) {			</span>
<span class="pc bpc" id="L323" title="2 of 4 branches missed.">			boolean status = summary.getStatus() != null &amp;&amp; Constants.PASS.equals(summary.getStatus());</span>
<span class="pc bpc" id="L324" title="1 of 2 branches missed.">			if (status) {</span>
<span class="fc" id="L325">				passCount = eventDBDtos.size();</span>
			} else {
<span class="nc" id="L327">				failCount = eventDBDtos.size();</span>
			}			
<span class="fc" id="L329">			sanction.setStatus(status);</span>
<span class="fc" id="L330">			sanction.setIsRequired(Boolean.TRUE);</span>
<span class="fc" id="L331">			sanction.setFailCount(failCount);</span>
<span class="fc" id="L332">			sanction.setPassCount(passCount);</span>
<span class="fc" id="L333">			sanction.setSanctionTotalRecords(eventDBDtos.size());</span>
<span class="fc" id="L334">		}</span>
		else
		{	
			//sending status value (NOT_REQUIRED) to UI
<span class="nc" id="L338">			sanction.setIsRequired(Boolean.FALSE);</span>
<span class="nc" id="L339">			sanction.setStatusValue(Constants.NOT_REQUIRED_UI);	</span>
<span class="nc" id="L340">			sanction.setSanctionTotalRecords(eventDBDtos.size());</span>
		}
		
		//method is extracted for code re-usability
<span class="fc" id="L344">		setSanctionResponse(sanction, eventDBDto, summary);		</span>
<span class="fc" id="L345">		return sanction;</span>

	}

	//this method is created for code re-usability from getSanction()
	private void setSanctionResponse(Sanction sanction, EventDBDto eventDBDto, SanctionSummary summary) {
<span class="pc bpc" id="L351" title="1 of 2 branches missed.">		if(summary !=null ){</span>
<span class="fc" id="L352">			sanction.setWorldCheck(summary.getWorldCheck());</span>
<span class="fc" id="L353">			sanction.setSanctionId(summary.getSanctionId());</span>
<span class="fc" id="L354">			sanction.setOfacList(summary.getOfacList());</span>
<span class="fc" id="L355">			sanction.setUpdatedOn(DateTimeFormatter.dateTimeFormatter(eventDBDto.getUpdatedOn()));</span>
<span class="fc" id="L356">			sanction.setUpdatedBy(eventDBDto.getUpdatedBy());</span>
		}
<span class="fc" id="L358">	}</span>

	/**
	 * Gets the fraugster.
	 *
	 * @param detailsDBDto
	 *            the details DB dto
	 * @return the fraugster
	 */
	private Fraugster getFraugster(DataAnonymisationDetailsDBDto detailsDBDto) {
<span class="fc" id="L368">		List&lt;EventDBDto&gt; eventDBDtos = detailsDBDto.getEventDBDto().get(Constants.FRAUGSTER);</span>
<span class="fc" id="L369">		Fraugster fraugster = new Fraugster();</span>
<span class="pc bpc" id="L370" title="2 of 4 branches missed.">		if (eventDBDtos == null || eventDBDtos.isEmpty()) {</span>
<span class="nc" id="L371">			fraugster.setFraugsterTotalRecords(0);</span>
<span class="nc" id="L372">			return fraugster;</span>
		}
<span class="fc" id="L374">		EventDBDto eventDBDto = eventDBDtos.get(0);</span>
<span class="pc bpc" id="L375" title="1 of 2 branches missed.">		if (eventDBDto == null) {</span>
<span class="nc" id="L376">			fraugster.setFraugsterTotalRecords(0);</span>
<span class="nc" id="L377">			return fraugster;</span>
		}
		
<span class="fc" id="L380">		FraugsterSummary fraugsterSummary = JsonConverterUtil.convertToObject(FraugsterSummary.class,</span>
<span class="fc" id="L381">				eventDBDto.getSummary());</span>
<span class="fc" id="L382">		checkForNotRequired(eventDBDtos, fraugster,  eventDBDto, fraugsterSummary);</span>
<span class="fc" id="L383">		return fraugster;</span>
	}

  private void checkForNotRequired(List&lt;EventDBDto&gt; eventDBDtos, Fraugster fraugster,  EventDBDto eventDBDto, FraugsterSummary fraugsterSummary) {
    //condition added by Vishal J to check whether we should do fraugster check for pfx contact
		/*
		 * 1) We are checking status of response from fraugster service if it is 'NOT_REQUIRED' 
		 *    then we are showing that on UI with other important fields also.
		 */
<span class="fc" id="L392">    Integer passCount = 0;</span>
<span class="fc" id="L393">    Integer failCount = 0;</span>
<span class="pc bpc" id="L394" title="2 of 4 branches missed.">		if(fraugsterSummary != null &amp;&amp; !Constants.NOT_REQUIRED.equalsIgnoreCase(fraugsterSummary.getStatus()))</span>
		{
<span class="pc bpc" id="L396" title="1 of 2 branches missed.">			if (eventDBDto.getUpdatedOn() != null) {</span>
<span class="nc" id="L397">				fraugster.setCreatedOn(DateTimeFormatter.dateTimeFormatter(eventDBDto.getUpdatedOn()));</span>
			}
<span class="fc" id="L399">			fraugster.setUpdatedBy(eventDBDto.getUpdatedBy());</span>
	
<span class="pc bpc" id="L401" title="2 of 4 branches missed.">			boolean status = fraugsterSummary.getStatus() != null &amp;&amp; Constants.PASS.equals(fraugsterSummary.getStatus());</span>
<span class="pc bpc" id="L402" title="1 of 2 branches missed.">			if (status) {</span>
<span class="fc" id="L403">				passCount = eventDBDtos.size();</span>
			} else {
<span class="nc" id="L405">				failCount = eventDBDtos.size();</span>
			}
<span class="fc" id="L407">			fraugster.setFraugsterId(fraugsterSummary.getFrgTransId());</span>
<span class="fc" id="L408">			fraugster.setScore(fraugsterSummary.getScore());</span>
<span class="fc" id="L409">			fraugster.setPassCount(passCount);</span>
<span class="fc" id="L410">			fraugster.setFailCount(failCount);</span>
<span class="fc" id="L411">			fraugster.setId(eventDBDto.getId());</span>
<span class="fc" id="L412">			fraugster.setIsRequired(Boolean.TRUE);</span>
<span class="fc" id="L413">			fraugster.setFraugsterTotalRecords(eventDBDtos.size());</span>
<span class="fc" id="L414">			fraugster.setStatus(status);</span>
<span class="fc" id="L415">		}</span>
		else
		{
			//sending status value to UI (NOT REQUIRED)
<span class="nc" id="L419">			fraugster.setIsRequired(Boolean.FALSE);</span>
<span class="nc" id="L420">			fraugster.setStatusValue(Constants.NOT_REQUIRED_UI);</span>
<span class="nc bnc" id="L421" title="All 2 branches missed.">			if (eventDBDto.getUpdatedOn() != null) {</span>
<span class="nc" id="L422">				fraugster.setCreatedOn(DateTimeFormatter.dateTimeFormatter(eventDBDto.getUpdatedOn()));</span>
			}
<span class="nc bnc" id="L424" title="All 2 branches missed.">			if (fraugsterSummary != null) {</span>
<span class="nc" id="L425">				fraugster.setFraugsterId(fraugsterSummary.getFrgTransId());</span>
<span class="nc" id="L426">				fraugster.setScore(fraugsterSummary.getScore());</span>
<span class="nc" id="L427">				fraugster.setPassCount(passCount);</span>
<span class="nc" id="L428">				fraugster.setFailCount(failCount);</span>
			}
<span class="nc" id="L430">			fraugster.setId(eventDBDto.getId());</span>
<span class="nc" id="L431">			fraugster.setUpdatedBy(eventDBDto.getUpdatedBy());</span>
<span class="nc" id="L432">			fraugster.setFraugsterTotalRecords(eventDBDtos.size());</span>
		}
<span class="fc" id="L434">  }</span>

	
	/**
	 * purpose of method:
	 * Get the contact details from EventServiceLog table and using most recent blacklisted data
	 *		to show on UI
	 * Implementation:
	 * 1) In this method we created list for blacklisted event if the list is empty or null 
	 *      then return blacklist with fail count(No. of columns)
	 * 2) If the list is present then fetch data from blacklist summary and set that data into UI perspective object Blacklist
	 */
	private Blacklist getBlacklist(DataAnonymisationDetailsDBDto detailsDBDto) {
		//constant added by Vishal J
<span class="fc" id="L448">		List&lt;EventDBDto&gt; blacklistEventDBDtos = detailsDBDto.getEventDBDto().get(Constants.BLACKLIST);		</span>
<span class="fc" id="L449">		Blacklist blacklist = new Blacklist();</span>
<span class="pc bpc" id="L450" title="2 of 4 branches missed.">		if (blacklistEventDBDtos == null || blacklistEventDBDtos.isEmpty()) {</span>
<span class="nc" id="L451">			return null;</span>
		}
		
<span class="fc" id="L454">		BlacklistSummary blacklistSummary = JsonConverterUtil.convertToObject(BlacklistSummary.class,</span>
<span class="fc" id="L455">				blacklistEventDBDtos.get(0).getSummary());</span>
<span class="pc bpc" id="L456" title="1 of 2 branches missed.">		if (blacklistSummary == null) {</span>
<span class="nc" id="L457">			return blacklist;</span>
		}
		
		
<span class="fc" id="L461">		setIntoBlacklistSummary(blacklistSummary);</span>
		//added method as setBlacklistFromBlacklistSummary
<span class="fc" id="L463">		setBlacklistFromBlacklistSummary(blacklistEventDBDtos, blacklist, blacklistSummary);</span>
		
		//added method to set blacklist matched data
<span class="fc" id="L466">		setBlacklistedMatchedData(blacklistSummary,blacklist);</span>
		
<span class="pc bpc" id="L468" title="1 of 2 branches missed.">		if(!blacklistSummary.getStatus().equalsIgnoreCase(Constants.NOT_REQUIRED))</span>
<span class="fc" id="L469">			setBlacklistPassAndFailCount(blacklist);</span>
<span class="fc" id="L470">		return blacklist;</span>
	}

	/**
	 * Fetch Data from BlacklistSummary and set Data into Blacklist
	 */
	private void setBlacklistFromBlacklistSummary(List&lt;EventDBDto&gt; blacklistEventDBDtos, Blacklist blacklist,
			BlacklistSummary blacklistSummary) {
		
		//condition added by Vishal J to show 'NOT REQUIRED' status on UI
<span class="pc bpc" id="L480" title="1 of 2 branches missed.">		if(!Constants.NOT_REQUIRED.equalsIgnoreCase(blacklistSummary.getStatus()))</span>
		{
<span class="pc bpc" id="L482" title="1 of 2 branches missed.">			if(Constants.SERVICE_FAILURE.equalsIgnoreCase(blacklistSummary.getStatus())){</span>
<span class="nc" id="L483">				setServiceFailureResponseForBlacklist(blacklist);</span>
			}
			else {
<span class="fc" id="L486">				updateBlacklist(blacklistEventDBDtos, blacklist, blacklistSummary);</span>
				}
			}
		else
		{
			//if status is 'NOT REQUIRED' then we will show that on UI for blacklist check
<span class="nc" id="L492">			blacklist.setStatusValue(Constants.NOT_REQUIRED_UI);</span>
<span class="nc" id="L493">			blacklist.setIsRequired(Boolean.FALSE);</span>
		}
		//end of - condition added
		
<span class="fc" id="L497">	}</span>

  private void updateBlacklist(List&lt;EventDBDto&gt; blacklistEventDBDtos, Blacklist blacklist,
      BlacklistSummary blacklistSummary) {
<span class="pc bpc" id="L501" title="1 of 2 branches missed.">    if(Constants.NOT_REQUIRED.equalsIgnoreCase(blacklistSummary.getName()))</span>
<span class="nc" id="L502">    	blacklist.setName(Constants.NOT_REQUIRED_UI);</span>
<span class="fc" id="L503">    else blacklist.setName(blacklistSummary.getName());</span>
<span class="pc bpc" id="L504" title="1 of 2 branches missed.">    if(Constants.NOT_REQUIRED.equalsIgnoreCase(blacklistSummary.getEmail()))</span>
<span class="fc" id="L505">    	blacklist.setEmail(Constants.NOT_REQUIRED_UI);</span>
<span class="nc" id="L506">    else blacklist.setEmail(blacklistSummary.getEmail());</span>
    //Set Domain for blacklist check for AT-112 -Saylee
<span class="pc bpc" id="L508" title="1 of 2 branches missed.">    if(Constants.NOT_REQUIRED.equalsIgnoreCase(blacklistSummary.getDomain()))</span>
<span class="nc" id="L509">    	blacklist.setDomain(Constants.NOT_REQUIRED_UI);</span>
<span class="fc" id="L510">    else blacklist.setDomain(blacklistSummary.getDomain());</span>
<span class="pc bpc" id="L511" title="1 of 2 branches missed.">    if(Constants.NOT_REQUIRED.equalsIgnoreCase(blacklistSummary.getIp()))</span>
<span class="fc" id="L512">    	blacklist.setIp(Constants.NOT_REQUIRED_UI);</span>
<span class="nc" id="L513">    else blacklist.setIp(blacklistSummary.getIp());</span>
<span class="pc bpc" id="L514" title="1 of 2 branches missed.">    blacklist.setPhone(!blacklistSummary.getPhone());</span>
<span class="fc" id="L515">    blacklist.setStatus(Constants.PASS.equals(blacklistSummary.getStatus()));</span>
<span class="fc" id="L516">    blacklist.setId(blacklistEventDBDtos.get(0).getId());</span>
<span class="fc" id="L517">    blacklist.setIsRequired(Boolean.TRUE);</span>
<span class="fc" id="L518">  }</span>

	private void setServiceFailureResponseForBlacklist(Blacklist blacklist) {
<span class="nc" id="L521">		blacklist.setName(Constants.BLACKLISTED_TRUE);</span>
<span class="nc" id="L522">		blacklist.setEmail(Constants.BLACKLISTED_TRUE);</span>
<span class="nc" id="L523">		blacklist.setDomain(Constants.BLACKLISTED_TRUE);</span>
<span class="nc" id="L524">		blacklist.setIp(Constants.BLACKLISTED_TRUE);</span>
<span class="nc" id="L525">		blacklist.setPhone(Boolean.FALSE);</span>
<span class="nc" id="L526">		blacklist.setStatus(Boolean.FALSE);</span>
<span class="nc" id="L527">		blacklist.setIsRequired(Boolean.TRUE);</span>
<span class="nc" id="L528">	}</span>

	/**
	 * set Data into BlacklistSummary
	 */
	private void setIntoBlacklistSummary(BlacklistSummary blacklistSummary) {
<span class="fc" id="L534">		Boolean blacklistSummaryPhone = Boolean.TRUE;</span>
<span class="fc" id="L535">		blacklistSummary.setName(blacklistSummary.getName());</span>
<span class="fc" id="L536">		blacklistSummary.setEmail(blacklistSummary.getEmail());</span>
<span class="fc" id="L537">		blacklistSummary.setDomain(blacklistSummary.getDomain());</span>
<span class="fc" id="L538">		blacklistSummary.setIp(blacklistSummary.getIp());</span>
<span class="pc bpc" id="L539" title="1 of 2 branches missed.">		blacklistSummary.setPhone(blacklistSummary.getPhone() == null ? blacklistSummaryPhone : blacklistSummary.getPhone());</span>
<span class="fc" id="L540">	}</span>


	/**
	 * Gets the ip.
	 *
	 * @param detailsDBDto
	 *            the details DB dto
	 * @return the ip
	 */
	private IpCheck getIp(DataAnonymisationDetailsDBDto detailsDBDto) {
<span class="fc" id="L551">		List&lt;EventDBDto&gt; ipEventDBDtos = detailsDBDto.getEventDBDto().get(Constants.IP);</span>
<span class="fc" id="L552">		IpCheck ip = new IpCheck();</span>
<span class="pc bpc" id="L553" title="2 of 4 branches missed.">		if (ipEventDBDtos == null || ipEventDBDtos.isEmpty()) {</span>
<span class="nc" id="L554">			ip.setIpCheckTotalRecords(0);</span>
<span class="nc" id="L555">			return ip;</span>
		}
<span class="fc" id="L557">		EventDBDto eventDBDto = ipEventDBDtos.get(0);</span>
<span class="fc" id="L558">		IpSummary ipSummary = JsonConverterUtil.convertToObject(IpSummary.class, eventDBDto.getSummary());</span>
		
		
<span class="pc bpc" id="L561" title="1 of 2 branches missed.">		if (eventDBDto.getUpdatedOn() != null) {</span>
<span class="nc" id="L562">			ip.setCheckedOn(DateTimeFormatter.dateTimeFormatter(eventDBDto.getUpdatedOn()));</span>
		}
<span class="pc bpc" id="L564" title="1 of 2 branches missed.">		if (ipSummary == null) {</span>
<span class="nc" id="L565">			return ip;</span>
		}
		
		/*condition added by Vishal J to check the status of IP check
		* If status is 'NOT_REQUIRED' then we wil show it on UI
		*/
<span class="pc bpc" id="L571" title="1 of 2 branches missed.">		if(!Constants.NOT_REQUIRED.equalsIgnoreCase(ipSummary.getStatus()))</span>
		{
<span class="fc" id="L573">			ip.setIpAddress(ipSummary.getIpAddress());</span>
<span class="fc" id="L574">			ip.setIpRule(ipSummary.getIpRule());</span>
<span class="fc" id="L575">			ip.setId(eventDBDto.getId());</span>
<span class="fc" id="L576">			ip.setStatus(eventDBDto.getStatus());			</span>
<span class="fc" id="L577">			ip.setIsRequired(Boolean.TRUE);	</span>
<span class="pc bpc" id="L578" title="3 of 4 branches missed.">			if(ip.getStatus().equalsIgnoreCase(Constants.PASS) || ip.getStatus().equalsIgnoreCase(Constants.FAIL)){</span>
<span class="fc" id="L579">				ip.setIpCity(Constants.IP_CITY_FIELD+StringUtils.isNullOrTrimEmptySetNA(ipSummary.getIpCity())+Constants.COMMA);</span>
<span class="fc" id="L580">				ip.setIpCountry(Constants.IP_COUNTRY_FIELD+StringUtils.isNullOrTrimEmptySetNA(ipSummary.getIpCountry())+Constants.COMMA);</span>
<span class="fc" id="L581">				ip.setGeoDifference(Constants.IP_DISTANCE_FIELD+StringUtils.isNullOrTrimEmptySetNA(DecimalFormatter.convertToOneDigit</span>
<span class="fc" id="L582">				(ipSummary.getGeoDifference()))+</span>
<span class="fc" id="L583">				StringUtils.isNullOrTrimEmptySetSpace(ipSummary.getUnit())+Constants.CLOSING_BRACKET);</span>
			}
			
		}
		else
		{
			//sending status value (NOT_REQUIRED) on UI
<span class="nc" id="L590">			ip.setIsRequired(Boolean.FALSE);</span>
<span class="nc" id="L591">			ip.setStatusValue(Constants.NOT_REQUIRED_UI);</span>
		}
<span class="fc" id="L593">		ip.setIpCheckTotalRecords(ipEventDBDtos.size());</span>
<span class="fc" id="L594">		return ip;</span>
	}
	
	private GlobalCheck getGlobalCheck(DataAnonymisationDetailsDBDto detailsDBDto){
<span class="fc" id="L598">		List&lt;EventDBDto&gt; gbEventDBDtos = detailsDBDto.getEventDBDto().get(Constants.GLOBALCHECK);</span>
<span class="fc" id="L599">		 GlobalCheck globalCheck = new GlobalCheck();</span>

<span class="pc bpc" id="L601" title="3 of 4 branches missed.">		if (gbEventDBDtos == null || gbEventDBDtos.isEmpty()) {</span>
<span class="fc" id="L602">			globalCheck.setGlobalCheckTotalRecords(0);</span>
<span class="fc" id="L603">			return globalCheck;</span>
		}
<span class="nc" id="L605">		EventDBDto eventDBDto = gbEventDBDtos.get(0);</span>
			
			/*condition added by Vishal J to check the status of Global check
			* If status is 'NOT_REQUIRED' then we will show it on UI
			*/
<span class="nc bnc" id="L610" title="All 2 branches missed.">		if(!Constants.NOT_REQUIRED.equalsIgnoreCase(eventDBDto.getStatus()))</span>
		{
<span class="nc" id="L612">			globalCheck.setEntityType(eventDBDto.getEitityType());</span>
<span class="nc" id="L613">			globalCheck.setId(eventDBDto.getId());</span>
<span class="nc" id="L614">			globalCheck.setStatus(eventDBDto.getStatus());</span>
				
<span class="nc" id="L616">			globalCheck.setIsRequired(Boolean.TRUE);</span>
		}
		else
		{
				//sending status value (NOT_REQUIRED) on UI
<span class="nc" id="L621">			globalCheck.setIsRequired(Boolean.FALSE);</span>
<span class="nc" id="L622">			globalCheck.setStatusValue(Constants.NOT_REQUIRED_UI);				</span>
		}
<span class="nc" id="L624">		globalCheck.setGlobalCheckTotalRecords(gbEventDBDtos.size());</span>
<span class="nc" id="L625">		return globalCheck;</span>
	}
	
	private CountryCheck getCountryCheck(DataAnonymisationDetailsDBDto detailsDBDto) {
<span class="fc" id="L629">		List&lt;EventDBDto&gt; ccEventDBDtos = detailsDBDto.getEventDBDto().get(Constants.COUNTRYCHECK);</span>
<span class="fc" id="L630">		CountryCheck countryCheck = new CountryCheck();</span>
<span class="pc bpc" id="L631" title="3 of 4 branches missed.">		if (ccEventDBDtos == null || ccEventDBDtos.isEmpty()) {</span>
<span class="fc" id="L632">			countryCheck.setCountryCheckTotalRecords(0);</span>
<span class="fc" id="L633">			return countryCheck;</span>
		}
<span class="nc" id="L635">		EventDBDto eventDBDto = ccEventDBDtos.get(0);</span>

			/*condition added by Vishal J to check the status of Country check
			* If status is 'NOT_REQUIRED' then we will show it on UI
			*/
<span class="nc bnc" id="L640" title="All 2 branches missed.">		if(!Constants.NOT_REQUIRED.equalsIgnoreCase(eventDBDto.getStatus()))</span>
		{
<span class="nc" id="L642">			countryCheck.setEntityType(eventDBDto.getEitityType());</span>
<span class="nc" id="L643">			countryCheck.setId(eventDBDto.getId());</span>
<span class="nc" id="L644">			countryCheck.setStatus(eventDBDto.getStatus());</span>
				
<span class="nc" id="L646">			countryCheck.setIsRequired(true);</span>
		}
		else
		{
				//sending status value (NOT_REQUIRED) on UI
<span class="nc" id="L651">			countryCheck.setIsRequired(false);</span>
<span class="nc" id="L652">			countryCheck.setStatusValue(Constants.NOT_REQUIRED_UI);</span>
		}	
<span class="nc" id="L654">		countryCheck.setCountryCheckTotalRecords(ccEventDBDtos.size());</span>
<span class="nc" id="L655">		return countryCheck;</span>
	}
	
	/**
	 * Gets the onfido.
	 *
	 * @param detailsDBDto the details DB dto
	 * @return the onfido
	 */
	private Onfido getOnfido(DataAnonymisationDetailsDBDto detailsDBDto) {
<span class="fc" id="L665">		Onfido onfido = new Onfido();</span>
<span class="fc" id="L666">		Integer passCount = 0;</span>
<span class="fc" id="L667">		Integer failCount = 0;</span>
		
<span class="fc" id="L669">		List&lt;EventDBDto&gt; eventDBDtos = detailsDBDto.getEventDBDto().get(Constants.ONFIDO);</span>
		
<span class="pc bpc" id="L671" title="3 of 4 branches missed.">		if (eventDBDtos == null || eventDBDtos.isEmpty()) {</span>
<span class="fc" id="L672">			onfido.setOnfidoTotalRecords(0);</span>
<span class="fc" id="L673">			return onfido;</span>
		}
<span class="nc" id="L675">		EventDBDto eventDBDto = eventDBDtos.get(0);</span>
<span class="nc" id="L676">		OnfidoSummary summary = JsonConverterUtil.convertToObject(OnfidoSummary.class,eventDBDto.getSummary());</span>
<span class="nc bnc" id="L677" title="All 4 branches missed.">		boolean status = summary.getStatus() != null &amp;&amp; Constants.PASS.equals(summary.getStatus());</span>
<span class="nc bnc" id="L678" title="All 2 branches missed.">		if (status) {</span>
<span class="nc" id="L679">			passCount = eventDBDtos.size();</span>
		} else {
<span class="nc" id="L681">			failCount = eventDBDtos.size();</span>
		}
<span class="nc" id="L683">		onfido.setIsRequired(Boolean.TRUE);</span>
<span class="nc bnc" id="L684" title="All 2 branches missed.">		if(Constants.PASS.equals(summary.getStatus())) {</span>
<span class="nc" id="L685">			onfido.setStatus(Boolean.TRUE);</span>
<span class="nc" id="L686">			onfido.setStatusValue(Constants.PASS);</span>
		}
		else {
<span class="nc" id="L689">			onfido.setStatus(Boolean.FALSE);</span>
<span class="nc" id="L690">			onfido.setStatusValue(Constants.FAIL);</span>
		}
<span class="nc" id="L692">		onfido.setReviewed(Constants.DASH_DETAILS_PAGE);</span>
<span class="nc bnc" id="L693" title="All 2 branches missed.">		if(null != summary.getReviewed()) {</span>
<span class="nc" id="L694">			onfido.setReviewed(summary.getReviewed());</span>
		}
<span class="nc" id="L696">		onfido.setOnfidoTotalRecords(eventDBDtos.size());</span>
<span class="nc" id="L697">		onfido.setEntityId(eventDBDto.getEntityId());</span>
<span class="nc" id="L698">		onfido.setEventServiceLogId(eventDBDto.getId());</span>
<span class="nc" id="L699">		onfido.setOnfidoId(summary.getOnfidoId());</span>
<span class="nc" id="L700">		onfido.setPassCount(passCount);</span>
<span class="nc" id="L701">		onfido.setFailCount(failCount);</span>
<span class="nc" id="L702">		onfido.setUpdatedBy(eventDBDto.getUpdatedBy());</span>
<span class="nc" id="L703">		onfido.setUpdatedOn(DateTimeFormatter.dateTimeFormatter(eventDBDto.getUpdatedOn()));</span>
<span class="nc" id="L704">		onfido.setOnfidoReport(JsonConverterUtil.convertToJsonWithoutNull(summary.getOnfidoReport()));</span>
		
<span class="nc" id="L706">		return onfido;</span>
	}
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>